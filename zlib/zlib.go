package zlib

import (
	"bytes"
	"gin-example/util"
	"sync"

	"github.com/klauspost/compress/zlib"
)

const (
	albumJSON       = `{"id":"1","title":"Blue Train","artist":"John Coltrane","price":56.99}`
	itemJson        = `{"id":"MCO1012837673","version":0,"site_id":3,"title":"Item De Testeo, Por Favor No Ofertar --kc:off","seller_id":1234,"category_id":"MLB7355","price":300,"base_price":300,"currency_id":"ARS","initial_quantity":1,"available_quantity":0,"buying_mode":1,"listing_type_id":"gold_pro","start_time":"2018-07-10T15:39:43.000-04:00","historical_start_time":"2018-07-10T15:39:43.000-04:00","stop_time":"2058-07-23T10:49:10.000-04:00","end_time":"2038-07-16T10:41:19.000-04:00","expiration_time":"2018-10-11T10:48:10.000-04:00","condition":1,"paycheck_status":null,"pictures":[{"id":"675571-MLA27723259923_072018","width":480,"height":640,"quality":"","source":"","downloaded":false},{"id":"954500-MLA27723266403_072018","width":480,"height":640,"quality":"","source":"","downloaded":false}],"description":"MLA637010482-1185322420","accepts_mercadopago":true,"payment_methods_ids":[],"shipping":{"mode":"not_specified","costs":[{"rule_id":null,"time":null,"cost":0,"destination":"**WITHPERS**"}],"payment_type":1,"dimensions":null,"shipping_methods":{"methods":null},"store_pick_up":false,"logistic_type":"drop_off"},"international_delivery_mode":0,"address":{"seller_address_id":173483791,"city":{"id":"","name":"San Isidro"},"state":{"id":"AR-B","name":"Buenos Aires"},"country":{"id":"AR","name":"Argentina"},"neighborhood":{"id":"","name":""},"contact_info":{"contact":"","other_info":"","country_code":"","area_code":"","phone":"","country_code2":"","area_code2":"","phone2":"","email":"","webpage":""},"street":"","street_number":"","zip_code":"","latitude":0,"longitude":0},"coverage_areas":[],"attributes":[{"id":"BRAKE_INCLUDED","name":"Freno","value_id":"242085","value_name":"S","value_struct":null,"attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":1572},{"id":"BRAND","name":"Marca","attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":510278957040621,"values":[{"id":"6891885","name":"Leccese","struct":null,"source":510278957040621},{"id":"6891886","name":"Another name","struct":null,"source":510278957040622}]},{"id":"ITEM_CONDITION","name":"Condicin del tem","value_id":"2230581","value_name":"Usado","value_struct":null,"attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":1572},{"id":"MODEL","name":"Modelo","value_id":null,"value_name":"ROLLER FLASH","value_struct":null,"attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":1577},{"id":"ROLLER_TYPE","name":"Tipo de patn","value_id":"400073","value_name":"Tradicional","value_struct":null,"attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":1},{"id":"SIZE_ADJUSTABLE","name":"Extensibles","value_id":"242085","value_name":"S","value_struct":null,"attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":1572},{"id":"USER","name":"Usuario","value_id":"104118","value_name":"Nia","value_struct":null,"attribute_group_id":"OTHERS","attribute_group_name":"Otros","source":1572}],"sale_terms":[{"id":"UNIT_PRICE","name":"Precio por Unidad","values":[{"id": null, "name": "$ 240", "struct": {"number":8,"unit":"USD"}},{"id": null, "name": "$ 300", "struct": {"number":10,"unit":"USD"}}]},{"id":"UNIT","name":"Precio por Unidad","value_id":null,"value_name":"mL","value_struct":{"number":123,"unit":"$"}}],"metadata":{"event_source":"rac"},"variations":[],"trust_safety_status":0,"site_status":4,"fraud_prevention_status":0,"credit_policy_status":0,"prontuario_status":0,"business_status":3,"cart_eligible_condition_has_manufacturing_time":false,"tags_map":{},"domain_id":"MLA-ROLLER_SKATES","deleted":false,"immediate_payment":false,"warnings":[],"inventory_id":null,"automatic_relist":false,"date_created":"2018-07-10T15:39:44.000-04:00","last_updated":"2018-07-23T11:51:47.000-04:00","referrer_id":1572,"sale_fee":36,"health":null,"source":"refetcher"}`
	searchApiGOJSON = `{"id":"MLB2178625164","title":"Camisa Térmica Voker Segunda Pele Proteção Solar Uv Dry Fit","condition":"new","status":"active","thumbnail_id":"715003-MLB70179427810_062023","listing_type_id":"gold_special","permalink":"https://produto.mercadolivre.com.br/MLB-2178625164-camisa-termica-voker-segunda-pele-proteco-solar-uv-dry-fit-_JM","buying_mode":"buy_it_now","site_id":"MLB","category_id":"MLB31447","domain_id":"MLB-T_SHIRTS","thumbnail":"http://http2.mlstatic.com/D_715003-MLB70179427810_062023-I.jpg","thumbnail_billboard":"http://http2.mlstatic.com/D_715003-MLB70179427810_062023-I.jpg","currency_id":"BRL","international_delivery_mode":"none","price":35.13,"original_price":54.9,"discount_source":"default","sold_quantity":52411,"available_quantity":4232,"official_store_id":5582,"seller_id":144871442,"accepts_mercadopago":true,"tags":["good_quality_picture","good_quality_thumbnail","loyalty_discount_eligible","certified_quality_thumbnail","immediate_payment","cart_eligible"],"deal_ids":["MLB19772","MLB19610","MLB19613","MLB19612","MLB13822","MLB15525","MLB14114","MLB14113","MLB18609","MLB19183","MLB19026","MLB19027","MLB16649","MLB13810","MLB10145","MLB18612","MLB18613","MLB17568","MLB16801","MLB13852","MLB18614","MLB17404","MLB16248","MLB14423","MLB16247","MLB14585","MLB16246","MLB14586","MLB16245","MLB14782","MLB16243","MLB16242","MLB15270","MLB19075","MLB19670","MLB15908","MLB19433","MLB19435","MLB19434","MLB17533","MLB17536","MLB14337","MLB18505","MLB19916","MLB14574","MLB14573","MLB15264","MLB19919","MLB19084","MLB19560","MLB19567","MLB17300","MLB11614","MLB17302","MLB19128","MLB19406","MLB19604","MLB18514","MLB19405","MLB19606","MLB19605","MLB19608","MLB17308","MLB18519","MLB14641","MLB13472","MLB19609","MLB15891"],"channels":["marketplace","mshops"],"shipping":{"logistic_type":"fulfillment","mode":"me2","store_pick_up":false,"local_pick_up":false,"free_shipping":false,"tags":[],"channels":[{"id":"marketplace","mode":"me2","logistic_type":"fulfillment","methods":[],"free_methods":[],"tags":[],"dimensions":null,"local_pick_up":false,"free_shipping":false,"store_pick_up":false},{"id":"mshops","mode":"me2","logistic_type":"fulfillment","methods":[],"free_methods":[],"tags":[],"dimensions":null,"local_pick_up":false,"free_shipping":false,"store_pick_up":false}],"methods":[],"dimensions":null},"stop_time":"2043-02-15T03:53:20Z","start_time":"2022-02-15T16:42:45Z","variations_response":["COLOR","SIZE"],"sale_terms":[{"id":"WARRANTY_TYPE","name":"Tipo de garantia","value_id":"2230280","value_name":"Garantia do vendedor","value_struct":null,"values":[{"id":"2230280","name":"Garantia do vendedor","struct":null}]},{"id":"WARRANTY_TIME","name":"Tempo de garantia","value_id":null,"value_name":"7 dias","value_struct":{"number":7,"unit":"dias"},"values":[{"id":null,"name":"7 dias","struct":{"number":7,"unit":"dias"}}]}],"seller_address":{"comment":"LOJA 1","address_line":"R SERVIDOR MUNICIPAL JOSE BELARMINO 14","zip_code":"35560000","id":1058618775,"latitude":-20.471365,"longitude":-45.139496,"country":{"id":"BR","name":"Brasil"},"state":{"id":"BR-MG","name":"Minas Gerais"},"city":{"id":"TUxCQ1NBTjYxYThl","name":"Santo Antônio do Monte"}},"location":{"address_line":"","latitude":null,"longitude":null,"country":{"id":"","name":""},"state":{"id":"","name":""},"city":{"id":null,"name":""},"neighborhood":{"id":"","name":""},"zip_code":"","subneighborhood":{"id":"","name":""}},"prices":{"id":"MLB2178625164","prices":[{"id":"2","type":"standard","currency_id":"BRL","exchange_rate_context":"DEFAULT","last_updated":"2022-02-15T16:47:52Z","amount":54.9,"conditions":{"eligible":true,"context_restrictions":[],"start_time":null,"end_time":null},"regular_amount":null,"metadata":{}},{"id":"7781","type":"promotion","currency_id":"BRL","exchange_rate_context":"DEFAULT","last_updated":"2023-07-31T23:00:31Z","amount":35.32,"conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":"2023-08-07T03:00:00Z","end_time":"2023-08-08T02:59:59Z"},"regular_amount":54.9,"metadata":{"promotion_id":"OFFER-MLB2178625164-1366744556","promotion_type":"deal_of_the_day"}},{"id":"7782","type":"promotion","currency_id":"BRL","exchange_rate_context":"DEFAULT","last_updated":"2023-07-31T23:00:31Z","amount":35.13,"conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":"2023-07-24T03:00:00Z","end_time":"2023-08-14T03:00:00Z"},"regular_amount":54.9,"metadata":{"campaign_id":"MLB19405","promotion_id":"OFFER-MLB2178625164-1340207951","promotion_type":"campaign"}},{"id":"7783","type":"promotion","currency_id":"BRL","exchange_rate_context":"DEFAULT","last_updated":"2023-07-31T23:00:31Z","amount":35.68,"conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":"2023-07-26T03:00:00Z","end_time":"2023-08-16T02:59:59Z"},"regular_amount":54.9,"metadata":{"promotion_id":"OFFER-MLB2178625164-1353438818","promotion_type":"custom"}}],"presentation":{"display_currency":"BRL"},"payment_method_prices":[{"id":"aa33e6b2-de41-4a1e-8d5e-0f5f399d06ba","conditions":{"allowed_methods":[{"id":"consumer_credits","issuer_id":12364,"payment_type_id":"digital_currency","installments":null}],"start_time":"2023-08-01T03:00:00Z","end_time":"2023-08-14T03:00:00Z","restricted_to_prices":[]},"value":5,"type":"percentage","currency_id":null,"metadata":{"purchase_discount_id":"MLB4041004","purchase_discount_type":"BD","purchase_discount_campaign_id":"P-MLB13285002","purchase_discount_rebate_id":"OFFER-MLB2178625164-10001268143"},"exchange_rate_context":"DEFAULT"},{"id":"ffe7824c-5942-4b10-b22d-b602cc0082fc","conditions":{"allowed_methods":[{"id":"visa","issuer_id":12510,"payment_type_id":"credit_card","installments":null}],"start_time":"2023-08-01T03:00:00Z","end_time":"2023-09-01T03:00:00Z","restricted_to_prices":[]},"value":5,"type":"percentage","currency_id":null,"metadata":{"purchase_discount_rebate_id":"OFFER-MLB2178625164-10001313452","purchase_discount_id":"MLB4055002","purchase_discount_type":"BD","purchase_discount_campaign_id":"P-MLB13285010"},"exchange_rate_context":"DEFAULT"}],"reference_prices":[{"id":"175","type":"min_standard","conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":null,"end_time":null},"amount":49.9,"currency_id":"BRL","exchange_rate_context":"DEFAULT","tags":[],"last_updated":"2022-07-04T04:17:27Z"},{"id":"176","type":"was","conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":"2022-07-04T04:17:27Z","end_time":"2022-07-11T04:17:27Z"},"amount":38.6,"currency_id":"BRL","exchange_rate_context":"DEFAULT","tags":[],"last_updated":"2022-07-04T04:17:27Z"}],"purchase_discounts":[{"purchase_discount_id":"MLB4041004","campaign_id":"P-MLB13285002","rebate_id":"OFFER-MLB2178625164-10001268143","type":"BD","discount_percentage":0.05,"conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":"2023-08-01T03:00:00Z","end_time":"2023-08-14T03:00:00Z"},"max_benefit_count":1,"max_discount_amount":30,"purchase_min_amount":1,"funding_mode":"coupon"},{"purchase_discount_id":"MLB4055002","campaign_id":"P-MLB13285010","rebate_id":"OFFER-MLB2178625164-10001313452","type":"BD","discount_percentage":0.05,"conditions":{"eligible":true,"context_restrictions":["channel_marketplace"],"start_time":"2023-08-01T03:00:00Z","end_time":"2023-09-01T03:00:00Z"},"max_benefit_count":1,"max_discount_amount":30,"purchase_min_amount":1,"funding_mode":"coupon"}]},"search_api":{"title":"Camisa Térmica Voker Segunda Pele Proteção Solar Uv Dry Fit","attributes":[{"id":"IS_TOM_BRAND","name":"É marca TOM","value_id":"242084","value_name":"Não","attribute_group_id":"","attribute_group_name":"","value_struct":null,"values":[{"id":"242084","name":"Não","struct":null,"source":2579503448603610}],"source":2579503448603610,"value_type":"boolean"},{"id":"BRAND","name":"Marca","value_id":"18701031","value_name":"Voker","attribute_group_id":"OTHERS","attribute_group_name":"Outros","value_struct":null,"values":[{"id":"18701031","name":"Voker","struct":null,"source":7413225415089012}],"source":7413225415089012,"value_type":"string"},{"id":"FILTRABLE_GENDER","name":"Gêneros filtráveis","value_id":"18549360","value_name":"Masculino","attribute_group_id":"OTHERS","attribute_group_name":"Outros","value_struct":null,"values":[{"id":"18549360","name":"Masculino","struct":null,"source":2579503448603610}],"source":2579503448603610,"value_type":"list"},{"id":"GENDER","name":"Gênero","value_id":"339666","value_name":"Masculino","attribute_group_id":"OTHERS","attribute_group_name":"Outros","value_struct":null,"values":[{"id":"339666","name":"Masculino","struct":null,"source":7413225415089012}],"source":7413225415089012,"value_type":"list"},{"id":"ITEM_CONDITION","name":"Condição do item","value_id":"2230284","value_name":"Novo","attribute_group_id":"OTHERS","attribute_group_name":"Outros","value_struct":null,"values":[{"id":"2230284","name":"Novo","struct":null,"source":7413225415089012}],"source":7413225415089012,"value_type":"list"},{"id":"MODEL","name":"Modelo","value_id":null,"value_name":"camiseta uv masculina UV 50  Manga Longa Slim camiseta uv masculina camiseta preta camisa uv masculina  camisetas masculina camisetas masculinas camiseta manga longa masculina camisa proteção uv camisa branca segunda pele","attribute_group_id":"OTHERS","attribute_group_name":"Outros","value_struct":null,"values":[{"id":null,"name":"camiseta uv masculina UV 50  Manga Longa Slim camiseta uv masculina camiseta preta camisa uv masculina  camisetas masculina camisetas masculinas camiseta manga longa masculina camisa proteção uv camisa branca segunda pele","struct":null,"source":7413225415089012}],"source":7413225415089012,"value_type":"string"},{"id":"UNITS_PER_PACKAGE","name":"Unidades por embalagem","value_id":null,"value_name":"01","attribute_group_id":"OTHERS","attribute_group_name":"Outros","value_struct":null,"values":[{"id":null,"name":"01","struct":null,"source":7413225415089012}],"source":7413225415089012,"value_type":"number"}],"thumbnail":"http://http2.mlstatic.com/camisa-termica-voker-segunda-pele-protecao-solar-uv-dry-fit-D_715003-MLB70179427810_062023-I.jpg","image_ratio":"0.97","seo_thumbnail":"http://http2.mlstatic.com/camisa-termica-voker-segunda-pele-protecao-solar-uv-dry-fit-D_715003-MLB70179427810_062023-I.jpg","variations":{"keys":{"k0":"http://http2.mlstatic.com"},"variations":null,"variations_list":[{"id":"174204732178","thumbnail":"k0/D_715003-MLB70179427810_062023-O.jpg","ratio":"0.97","name":"Azul-escuro","picture_qty":5,"inventory_id":"KARM78776"},{"id":"174204732175","thumbnail":"k0/D_793633-MLB70179427718_062023-O.jpg","ratio":"0.53","name":"Cinza-escuro","picture_qty":5,"inventory_id":"CBLU78117"},{"id":"174204732177","thumbnail":"k0/D_876088-MLB70179427694_062023-O.jpg","ratio":"0.97","name":"Preto","picture_qty":5,"inventory_id":"RPWP78996"},{"id":"175746219303","thumbnail":"k0/D_683418-MLB70179427636_062023-O.jpg","ratio":"0.56","name":"Laranja","picture_qty":5,"inventory_id":"QEOZ57170"},{"id":"175746219309","thumbnail":"k0/D_868715-MLB70179427634_062023-O.jpg","ratio":"0.49","name":"Verde","picture_qty":4,"inventory_id":"VWRG57158"},{"id":"174548021938","thumbnail":"k0/D_875359-MLB70179427710_062023-O.jpg","ratio":"0.53","name":"Azul","picture_qty":5,"inventory_id":"LAQX93059"},{"id":"174204732174","thumbnail":"k0/D_876088-MLB70179427694_062023-O.jpg","ratio":"0.97","name":"Preto","picture_qty":5,"inventory_id":"UCYX80836"},{"id":"174204732173","thumbnail":"k0/D_876088-MLB70179427694_062023-O.jpg","ratio":"0.97","name":"Preto","picture_qty":5,"inventory_id":"YZGH79114"},{"id":"175746219308","thumbnail":"k0/D_868715-MLB70179427634_062023-O.jpg","ratio":"0.49","name":"Verde","picture_qty":4,"inventory_id":"HNZJ56902"},{"id":"174204732183","thumbnail":"k0/D_793633-MLB70179427718_062023-O.jpg","ratio":"0.53","name":"Cinza-escuro","picture_qty":5,"inventory_id":"JOOL80014"},{"id":"174469069629","thumbnail":"k0/D_876088-MLB70179427694_062023-O.jpg","ratio":"0.97","name":"Preto","picture_qty":5,"inventory_id":"RDZQ01236"},{"id":"174204732179","thumbnail":"k0/D_793633-MLB70179427718_062023-O.jpg","ratio":"0.53","name":"Cinza-escuro","picture_qty":5,"inventory_id":"HNTE79677"},{"id":"174204732176","thumbnail":"k0/D_793633-MLB70179427718_062023-O.jpg","ratio":"0.53","name":"Cinza-escuro","picture_qty":5,"inventory_id":"EURN77447"},{"id":"174204732181","thumbnail":"k0/D_715003-MLB70179427810_062023-O.jpg","ratio":"0.97","name":"Azul-escuro","picture_qty":5,"inventory_id":"MSPZ80424"},{"id":"174204732182","thumbnail":"k0/D_876088-MLB70179427694_062023-O.jpg","ratio":"0.97","name":"Preto","picture_qty":5,"inventory_id":"FZJO79450"},{"id":"174204732180","thumbnail":"k0/D_715003-MLB70179427810_062023-O.jpg","ratio":"0.97","name":"Azul-escuro","picture_qty":5,"inventory_id":"PKKZ76540"},{"id":"174204732184","thumbnail":"k0/D_715003-MLB70179427810_062023-O.jpg","ratio":"0.97","name":"Azul-escuro","picture_qty":5,"inventory_id":"JPOV81148"},{"id":"174204732187","thumbnail":"k0/D_869600-MLB70179427686_062023-O.jpg","ratio":"0.53","name":"Bordô","picture_qty":5,"inventory_id":"WBEK78626"},{"id":"174204732188","thumbnail":"k0/D_869600-MLB70179427686_062023-O.jpg","ratio":"0.53","name":"Bordô","picture_qty":5,"inventory_id":"RJRU78880"},{"id":"174469069628","thumbnail":"k0/D_715003-MLB70179427810_062023-O.jpg","ratio":"0.97","name":"Azul-escuro","picture_qty":5,"inventory_id":"DGNQ01454"},{"id":"174548021939","thumbnail":"k0/D_875359-MLB70179427710_062023-O.jpg","ratio":"0.53","name":"Azul","picture_qty":5,"inventory_id":"TFIV04074"},{"id":"174548021940","thumbnail":"k0/D_875359-MLB70179427710_062023-O.jpg","ratio":"0.53","name":"Azul","picture_qty":5,"inventory_id":"JWZL04192"},{"id":"174548021941","thumbnail":"k0/D_875359-MLB70179427710_062023-O.jpg","ratio":"0.53","name":"Azul","picture_qty":5,"inventory_id":"SURT03738"},{"id":"174548021943","thumbnail":"k0/D_715789-MLB70179427674_062023-O.jpg","ratio":"0.53","name":"Vermelho","picture_qty":5,"inventory_id":"PVUS90376"},{"id":"174548021944","thumbnail":"k0/D_610061-MLB70179427748_062023-O.jpg","ratio":"0.53","name":"Branco","picture_qty":5,"inventory_id":"ACXI03937"},{"id":"174548021945","thumbnail":"k0/D_715789-MLB70179427674_062023-O.jpg","ratio":"0.53","name":"Vermelho","picture_qty":5,"inventory_id":"MMKR92532"},{"id":"174548021946","thumbnail":"k0/D_610061-MLB70179427748_062023-O.jpg","ratio":"0.53","name":"Branco","picture_qty":5,"inventory_id":"LCFZ03842"},{"id":"174548021947","thumbnail":"k0/D_715789-MLB70179427674_062023-O.jpg","ratio":"0.53","name":"Vermelho","picture_qty":5,"inventory_id":"KXIO03900"},{"id":"174548021948","thumbnail":"k0/D_610061-MLB70179427748_062023-O.jpg","ratio":"0.53","name":"Branco","picture_qty":5,"inventory_id":"GYWC04251"},{"id":"174548021949","thumbnail":"k0/D_715789-MLB70179427674_062023-O.jpg","ratio":"0.53","name":"Vermelho","picture_qty":5,"inventory_id":"MJBA91214"},{"id":"174548021950","thumbnail":"k0/D_610061-MLB70179427748_062023-O.jpg","ratio":"0.53","name":"Branco","picture_qty":5,"inventory_id":"GRCK93777"},{"id":"175746219304","thumbnail":"k0/D_683418-MLB70179427636_062023-O.jpg","ratio":"0.56","name":"Laranja","picture_qty":5,"inventory_id":"YOBX56828"},{"id":"175746219305","thumbnail":"k0/D_683418-MLB70179427636_062023-O.jpg","ratio":"0.56","name":"Laranja","picture_qty":5,"inventory_id":"WNBC57115"},{"id":"175746219310","thumbnail":"k0/D_868715-MLB70179427634_062023-O.jpg","ratio":"0.49","name":"Verde","picture_qty":4,"inventory_id":"QDIG56828"},{"id":"175746219313","thumbnail":"k0/D_936060-MLB70179427758_062023-O.jpg","ratio":"0.53","name":"Verde-claro","picture_qty":5,"inventory_id":"JPEH56178"},{"id":"175746219314","thumbnail":"k0/D_936060-MLB70179427758_062023-O.jpg","ratio":"0.53","name":"Verde-claro","picture_qty":5,"inventory_id":"QEJM57854"},{"id":"175746219315","thumbnail":"k0/D_936060-MLB70179427758_062023-O.jpg","ratio":"0.53","name":"Verde-claro","picture_qty":5,"inventory_id":"LHDI56393"},{"id":"175746219316","thumbnail":"k0/D_936060-MLB70179427758_062023-O.jpg","ratio":"0.53","name":"Verde-claro","picture_qty":5,"inventory_id":"GLPU55889"},{"id":"178194812025","thumbnail":"k0/D_994191-MLB70179427774_062023-O.jpg","ratio":"0.53","name":"Terracota","picture_qty":4,"inventory_id":"FTWZ28518"},{"id":"178194812027","thumbnail":"k0/D_994191-MLB70179427774_062023-O.jpg","ratio":"0.53","name":"Terracota","picture_qty":4,"inventory_id":"JSMB27408"},{"id":"178194812029","thumbnail":"k0/D_994191-MLB70179427774_062023-O.jpg","ratio":"0.53","name":"Terracota","picture_qty":4,"inventory_id":"ANJK28560"},{"id":"178194812039","thumbnail":"k0/D_627775-MLB70179427746_062023-O.jpg","ratio":"0.53","name":"Azul-petróleo","picture_qty":4,"inventory_id":"LKOR28807"},{"id":"178194812041","thumbnail":"k0/D_627775-MLB70179427746_062023-O.jpg","ratio":"0.53","name":"Azul-petróleo","picture_qty":4,"inventory_id":"HEVS28600"},{"id":"178194812043","thumbnail":"k0/D_627775-MLB70179427746_062023-O.jpg","ratio":"0.53","name":"Azul-petróleo","picture_qty":4,"inventory_id":"EGLX27973"},{"id":"178194812045","thumbnail":"k0/D_627775-MLB70179427746_062023-O.jpg","ratio":"0.53","name":"Azul-petróleo","picture_qty":4,"inventory_id":"GQEZ28038"}],"colors_qty":12,"pictures_qty":61,"colors_id":["COLOR","SIZE"]}},"catalog_listing":false}`
	itemKVSGOJSON   = `{"id":"MLA1150976407","version": 1801,"site_id": 1,"title":"Remera Pew Pew Madafakas 100% Algodon Icaro Remeras Local","seller_id": 754618081,"category_id":"MLA109042","user_product_id": null,"price": 7499,"base_price": 7499,"currency_id":"ARS","initial_quantity": 1716,"available_quantity": 1300,"buying_mode": 1,"listing_type_id":"gold_special","start_time":"2022-08-10T13:15:55.000-04:00","historical_start_time":"2022-08-10T13:15:55.000-04:00","stop_time":"2042-08-05T00:00:00.000-04:00","end_time":"2042-08-05T00:00:00.000-04:00","expiration_time":"2024-02-16T17:24:58.000-04:00","condition": 1,"paycheck_status": null,"pictures": [{"entity_id": 192730583557,"id":"805457-MLA51076405822_082022","width": 949,"height": 916,"quality":"","source":"","downloaded": false,"settings": null}],"video_id":"xgMXDkxPXPc","description":"","accepts_mercadopago": true,"payment_methods_ids": [],"shipping": {"mode":"me2","costs": [{"entity_id": 192730583558,"rule_id": null,"time": null,"cost": 0,"destination":"**WITHPERS**"}],"payment_type": 0,"dimensions": null,"shipping_methods": {"methods": null,"tags": ["self_service_in"]    },"store_pick_up": false,"logistic_type":"xd_drop_off"},"international_delivery_mode": 0,"address": {"entity_id": 192730583556,"seller_address_id": 1212454147,"city": {"id":"","name":"Almagro"},"state": {"id":"AR-C","name":"Capital Federal"},"country": {"id":"AR","name":"Argentina"},"neighborhood": {"id":"","name":""},"contact_info": {"contact":"","other_info":"","country_code":"","area_code":"","phone":"","country_code2":"","area_code2":"","phone2":"","email":"","webpage":""},"street":"","street_number":"","zip_code":"","latitude": 0,"longitude": 0  },"coverage_areas": [],"attributes": [{"entity_id": 234586207555,"id":"IS_TOM_BRAND","name":"Es marca TOM","value_id":"242084","value_name":"No","value_struct": null,"values": [],"attribute_group_id": null,"attribute_group_name": null,"value_type":"boolean","source": 2579503448603610    },{"entity_id": 236209801310,"id":"AGE_GROUP","name":"Edad","value_id":"6725189","value_name":"Adultos","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"list","source": 2579503448603610    },{"entity_id": 221779994302,"id":"BRAND","name":"Marca","value_id":"6880366","value_name":"Icaro","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994303,"id":"COMPOSITION","name":"Composición","values": [{"id":"4782460","name":"Algodón","struct": null,"source": 2860837171021627}],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994304,"id":"FABRIC_DESIGN","name":"Diseño de la tela","value_id":"930483","value_name":"Liso","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994313,"id":"FABRIC_TYPE","name":"Tipo de tela","value_id":"11997293","value_name":"Algodón","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 236209801308,"id":"FILTRABLE_GENDER","name":"Géneros filtrables","values": [{"id":"18549361","name":"Mujer","struct": null,"source": 2579503448603610        },{"id":"18549360","name":"Hombre","struct": null,"source": 2579503448603610}],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"list","source": 7363830417619661    },{"entity_id": 221779994305,"id":"GARMENT_TYPE","name":"Tipo de prenda","value_id":"12038970","value_name":"Remera","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"list","source": 2860837171021627    },{"entity_id": 221779994306,"id":"GENDER","name":"Género","value_id":"110461","value_name":"Sin género","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"list","source": 2860837171021627    },{"entity_id": 221779994307,"id":"IS_SPORTIVE","name":" Es deportiva","value_id":"242084","value_name":"No","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"boolean","source": 2860837171021627    },{"entity_id": 221779994301,"id":"ITEM_CONDITION","name":"Condición del ítem","value_id":"2230284","value_name":"Nuevo","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"list","source": 2860837171021627    },{"entity_id": 221779994308,"id":"MAIN_MATERIAL","name":"Material principal","value_id":"466793","value_name":"Algodón","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994309,"id":"MODEL","name":"Modelo","value_id": null,"value_name":"Pew Pew","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994314,"id":"RECOMMENDED_USES","name":"Usos recomendados","values": [{"id":"-1","name": null,"struct": null,"source": 2860837171021627}],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994310,"id":"SLEEVE_TYPE","name":"Tipo de manga","value_id":"466804","value_name":"Corta","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"list","source": 2860837171021627    },{"entity_id": 221779994311,"id":"T_SHIRT_COLLAR_TYPE","name":"Tipo de cuello","value_id":"466787","value_name":"Redondo","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"string","source": 2860837171021627    },{"entity_id": 221779994312,"id":"UNITS_PER_PACKAGE","name":"Unidades por envase","value_id": null,"value_name":"1","value_struct": null,"values": [],"attribute_group_id":"OTHERS","attribute_group_name":"Otros","value_type":"number","source": 2860837171021627}],"sale_terms": [{"entity_id": 215241862428,"id":"WARRANTY_TYPE","name":"Tipo de garantía","value_type":"list","value_id":"2230280","value_name":"Garantía del vendedor","value_struct": null,"values": []    },{"entity_id": 215241862429,"id":"WARRANTY_TIME","name":"Tiempo de garantía","value_type":"number_unit","value_id": null,"value_name":"1 meses","value_struct": {"number": 1,"unit":"meses"},"values": []}],"metadata": {"client_id": 7363830417619661,"event_source":"item","request_id":"46e63cec-fdd2-457d-bc2e-c5ff1c09f1f0"},"item_stock_id":"","variations": [{"id": 174997914735,"price": 7499,"user_product_id": null,"available_quantity": 20,"initial_quantity": 100,"seller_custom_field": null,"inventory_id":"EUGB22627","catalog_product_id": null,"blame": {"catalog_product_id": null      },"attributes": [{"entity_id": 215771375981,"id":"COLOR","name":"Color","source": 2860837171021627,"value_type":"string","value_id":"52049","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 215771375980,"id":"SIZE","name":"Talle","source": 2860837171021627,"value_type":"string","value_id":"2282666","value_name":"M","value_struct": null,"values": []}],"detail_attributes": [{"entity_id": 218191157650,"id":"MAIN_COLOR","name":"Color principal","source": 2860837171021627,"value_type":"list","value_id":"2450295","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 234399470300,"id":"FILTRABLE_SIZE","name":"Talle filtrable","source": 2579503448603610,"value_type":"list","values": [{"id":"12917795","name":"M","struct": null,"source": 2579503448603610}]}],"sale_terms": [],"picture_ids": ["805457-MLA51076405822_082022"],"parent_historic_sold_quantity": 0,"status": 0,"item_relations": [],"item_stock_id":"","last_updated":"2023-07-26T08:59:27.000-04:00"},{"id": 174997914736,"price": 7499,"user_product_id": null,"available_quantity": 22,"initial_quantity": 100,"seller_custom_field": null,"inventory_id":"RLJX22517","catalog_product_id": null,"blame": {"catalog_product_id": null      },"attributes": [{"entity_id": 215771375982,"id":"COLOR","name":"Color","source": 2860837171021627,"value_type":"string","value_id":"52049","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 215771375983,"id":"SIZE","name":"Talle","source": 2860837171021627,"value_type":"string","value_id":"3423417","value_name":"XXL","value_struct": null,"values": []}],"detail_attributes": [{"entity_id": 218191157651,"id":"MAIN_COLOR","name":"Color principal","source": 2860837171021627,"value_type":"list","value_id":"2450295","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 234399470302,"id":"FILTRABLE_SIZE","name":"Talle filtrable","source": 2579503448603610,"value_type":"list","values": [{"id":"12917846","name":"2XL","struct": null,"source": 2579503448603610}]}],"sale_terms": [],"picture_ids": ["805457-MLA51076405822_082022"],"parent_historic_sold_quantity": 0,"status": 0,"item_relations": [],"item_stock_id":"","last_updated":"2023-07-31T17:24:58.000-04:00"},{"id": 174997914737,"price": 7499,"user_product_id": null,"available_quantity": 55,"initial_quantity": 100,"seller_custom_field": null,"inventory_id":"CVCN21801","catalog_product_id": null,"blame": {"catalog_product_id": null      },"attributes": [{"entity_id": 215771375984,"id":"COLOR","name":"Color","source": 2860837171021627,"value_type":"string","value_id":"52049","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 215771375985,"id":"SIZE","name":"Talle","source": 2860837171021627,"value_type":"string","value_id":"17552780","value_name":"S","value_struct": null,"values": []}],"detail_attributes": [{"entity_id": 218191157652,"id":"MAIN_COLOR","name":"Color principal","source": 2860837171021627,"value_type":"list","value_id":"2450295","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 234399470298,"id":"FILTRABLE_SIZE","name":"Talle filtrable","source": 2579503448603610,"value_type":"list","values": [{"id":"12917796","name":"S","struct": null,"source": 2579503448603610}]}],"sale_terms": [],"picture_ids": ["805457-MLA51076405822_082022"],"parent_historic_sold_quantity": 0,"status": 0,"item_relations": [],"item_stock_id":"","last_updated":"2023-07-20T20:05:20.000-04:00"},{"id": 174997914738,"price": 7499,"user_product_id": null,"available_quantity": 976,"initial_quantity": 1100,"seller_custom_field": null,"inventory_id":"WSNO22636","catalog_product_id": null,"blame": {"catalog_product_id": null      },"attributes": [{"entity_id": 215771375986,"id":"COLOR","name":"Color","source": 2860837171021627,"value_type":"string","value_id":"52049","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 215771375987,"id":"SIZE","name":"Talle","source": 2860837171021627,"value_type":"string","value_id":"3330811","value_name":"L","value_struct": null,"values": []}],"detail_attributes": [{"entity_id": 218191157653,"id":"MAIN_COLOR","name":"Color principal","source": 2860837171021627,"value_type":"list","value_id":"2450295","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 234399470304,"id":"FILTRABLE_SIZE","name":"Talle filtrable","source": 2579503448603610,"value_type":"list","values": [{"id":"12917802","name":"L","struct": null,"source": 2579503448603610}]}],"sale_terms": [],"picture_ids": ["805457-MLA51076405822_082022"],"parent_historic_sold_quantity": 0,"status": 0,"item_relations": [],"item_stock_id":"","last_updated":"2023-07-18T20:46:59.000-04:00"},{"id": 174997914739,"price": 7499,"user_product_id": null,"available_quantity": 227,"initial_quantity": 316,"seller_custom_field": null,"inventory_id":"WYAZ22125","catalog_product_id": null,"blame": {"catalog_product_id": null      },"attributes": [{"entity_id": 215771375989,"id":"COLOR","name":"Color","source": 2860837171021627,"value_type":"string","value_id":"52049","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 215771375988,"id":"SIZE","name":"Talle","source": 2860837171021627,"value_type":"string","value_id":"433336","value_name":"XL","value_struct": null,"values": []}],"detail_attributes": [{"entity_id": 218191157654,"id":"MAIN_COLOR","name":"Color principal","source": 2860837171021627,"value_type":"list","value_id":"2450295","value_name":"Negro","value_struct": null,"values": []        },{"entity_id": 234399470306,"id":"FILTRABLE_SIZE","name":"Talle filtrable","source": 2579503448603610,"value_type":"list","values": [{"id":"12917787","name":"XL","struct": null,"source": 2579503448603610}]}],"sale_terms": [],"picture_ids": ["805457-MLA51076405822_082022"],"parent_historic_sold_quantity": 0,"status": 0,"item_relations": [],"item_stock_id":"","last_updated":"2023-07-30T20:43:20.000-04:00"}],"trust_safety_status": null,"site_status": 2,"fraud_prevention_status": null,"credit_policy_status": 0,"prontuario_status": 0,"business_status": 2,"cart_eligible_condition_has_manufacturing_time": false,"tags_map": {"good_quality_picture": true,"good_quality_thumbnail": true  },"warranty":"Garantía del vendedor: 1 meses","blame": {"catalog_product_id": null  },"price_metadata": {"standard_price": 7499,"currency_id":"ARS","exchange_rate_context":"DEFAULT","display_currency":"ARS","client_id": 4060709329251625,"exchange_rate": null,"calculated_global_price": null,"last_updated":"2023-06-08T16:32:13.165Z","should_validate_amount_strictly": false  },"domain_id":"MLA-T_SHIRTS","deleted": false,"immediate_payment": true,"warnings": [],"inventory_id": null,"deal_ids": [],"automatic_relist": false,"date_created":"2022-08-10T13:15:55.000-04:00","last_updated":"2023-08-01T23:45:59.894-04:00","fee": 0,"referrer_id": 2860837171021627,"sale_fee": 1362.33,"health": 0.6,"catalog_listing": null,"item_relations": [],"channels": ["marketplace","mshops"],"shipping_channels": [{"mode":"me2","costs": [{"destination":"**WITHPERS**","cost": 0,"time": null,"rule_id": null}],"free_methods": null,"free_shipping": false,"channel":"marketplace","local_pick_up": true,"default_channel": true,"logistic_type":"xd_drop_off","tags": ["self_service_in"],"dimensions": null,"store_pick_up": false    },{"mode":"me2","costs": [{"destination":"**WITHPERS**","cost": 0,"time": null,"rule_id": null}],"free_methods": null,"free_shipping": false,"channel":"mshops","local_pick_up": true,"default_channel": false,"logistic_type":"xd_drop_off","tags": ["self_service_in"],"dimensions": null,"store_pick_up": false}],"sales": [{"total": 413,"channel":"marketplace"},{"total": 3,"channel":"mshops"}],"bundle": null,"status_restrictions": [],"source":"red_wire"}`
)

var (
	albumJSONBytes = util.ToBytes(albumJSON)
	itemJsonBytes  = util.ToBytes(itemJson)
	//searchJsonBytes: 17439
	//gzipSearchApiGOJSON: 3735
	searchJsonBytes = util.ToBytes(searchApiGOJSON)
	//itemKVSJsonBytes: 14867
	//gzipItemKVSGOJSON: 3101
	itemKVSJsonBytes = util.ToBytes(itemKVSGOJSON)
)

var zlibPool = &sync.Pool{
	New: func() interface{} {
		return zlib.NewWriter(nil)
	},
}

func zlibEncodeClose(source []byte) ([]byte, error) {
	var b bytes.Buffer

	z := zlibPool.Get().(*zlib.Writer)
	defer zlibPool.Put(z)
	z.Reset(&b)

	_, err := z.Write(source)
	if err != nil {
		return nil, err
	}

	if err = z.Close(); err != nil {
		return nil, err
	}

	return b.Bytes(), nil
}

func zlibEncodeFlush(source []byte) ([]byte, error) {
	var b bytes.Buffer

	z := zlibPool.Get().(*zlib.Writer)
	defer zlibPool.Put(z)
	z.Reset(&b)

	_, err := z.Write(source)
	if err != nil {
		return nil, err
	}

	if err = z.Flush(); err != nil {
		return nil, err
	}

	return b.Bytes(), nil
}

func zlibEncode2(source []byte) ([]byte, error) {
	var b bytes.Buffer

	z := zlib.NewWriter(&b)

	_, err := z.Write(source)
	if err != nil {
		return nil, err
	}

	if err = z.Close(); err != nil {
		return nil, err
	}

	return b.Bytes(), nil
}
